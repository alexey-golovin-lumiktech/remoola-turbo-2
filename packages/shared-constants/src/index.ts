/**
 * Canonical error codes for API exceptions. Each code is used in exactly one
 * place in the API so that code uniquely identifies the throw site.
 */
export const errorCodes = {
  // Payments – consumer-payments.service (one code per throw)
  INSUFFICIENT_BALANCE_WITHDRAW: `INSUFFICIENT_BALANCE_WITHDRAW`,
  INSUFFICIENT_BALANCE_TRANSFER: `INSUFFICIENT_BALANCE_TRANSFER`,
  PAYMENT_REQUEST_NOT_FOUND_GET: `PAYMENT_REQUEST_NOT_FOUND_GET`,
  PAYMENT_REQUEST_NOT_FOUND_SEND_DRAFT: `PAYMENT_REQUEST_NOT_FOUND_SEND_DRAFT`,
  PAYMENT_ACCESS_DENIED_GET: `PAYMENT_ACCESS_DENIED_GET`,
  PAYMENT_ACCESS_DENIED_SEND_DRAFT: `PAYMENT_ACCESS_DENIED_SEND_DRAFT`,
  RECIPIENT_NOT_FOUND_START_PAYMENT: `RECIPIENT_NOT_FOUND_START_PAYMENT`,
  RECIPIENT_NOT_FOUND_TRANSFER: `RECIPIENT_NOT_FOUND_TRANSFER`,
  CANNOT_TRANSFER_TO_SELF_START_PAYMENT: `CANNOT_TRANSFER_TO_SELF_START_PAYMENT`,
  CANNOT_TRANSFER_TO_SELF_TRANSFER: `CANNOT_TRANSFER_TO_SELF_TRANSFER`,
  INVALID_AMOUNT_START_PAYMENT: `INVALID_AMOUNT_START_PAYMENT`,
  INVALID_AMOUNT_CREATE_REQUEST: `INVALID_AMOUNT_CREATE_REQUEST`,
  INVALID_AMOUNT_SEND_DRAFT: `INVALID_AMOUNT_SEND_DRAFT`,
  INVALID_AMOUNT_WITHDRAW: `INVALID_AMOUNT_WITHDRAW`,
  INVALID_AMOUNT_TRANSFER: `INVALID_AMOUNT_TRANSFER`,
  REQUEST_FROM_SELF_BY_ID: `REQUEST_FROM_SELF_BY_ID`,
  REQUEST_FROM_SELF_BY_EMAIL: `REQUEST_FROM_SELF_BY_EMAIL`,
  INVALID_DATE: `INVALID_DATE`,
  ONLY_DRAFT_REQUESTS_CAN_BE_SENT: `ONLY_DRAFT_REQUESTS_CAN_BE_SENT`,
  INVALID_LEDGER_STATE_EMAIL_PAYMENT_SEND: `INVALID_LEDGER_STATE_EMAIL_PAYMENT_SEND`,
  INVALID_LEDGER_STATE_DRAFT: `INVALID_LEDGER_STATE_DRAFT`,
  AMOUNT_EXCEEDS_PER_OPERATION_LIMIT: `AMOUNT_EXCEEDS_PER_OPERATION_LIMIT`,
  AMOUNT_EXCEEDS_DAILY_LIMIT: `AMOUNT_EXCEEDS_DAILY_LIMIT`,
  IDEMPOTENCY_KEY_REQUIRED_WITHDRAW: `IDEMPOTENCY_KEY_REQUIRED_WITHDRAW`,
  IDEMPOTENCY_KEY_REQUIRED_TRANSFER: `IDEMPOTENCY_KEY_REQUIRED_TRANSFER`,

  // Auth – auth.service, auth.controller, google-oauth, dto
  ACCOUNT_SUSPENDED: `ACCOUNT_SUSPENDED`,
  PROFILE_SUSPENDED: `PROFILE_SUSPENDED`,
  INVALID_CREDENTIALS: `INVALID_CREDENTIALS`,
  NO_IDENTITY_RECORD: `NO_IDENTITY_RECORD`,
  INVALID_REFRESH_TOKEN: `INVALID_REFRESH_TOKEN`,
  INVALID_OAUTH_EXCHANGE_TOKEN: `INVALID_OAUTH_EXCHANGE_TOKEN`,
  INVALID_GOOGLE_SIGNUP_TOKEN: `INVALID_GOOGLE_SIGNUP_TOKEN`,
  GOOGLE_SIGNUP_MISSING_EMAIL: `GOOGLE_SIGNUP_MISSING_EMAIL`,
  GOOGLE_EMAIL_NOT_VERIFIED_SIGNUP: `GOOGLE_EMAIL_NOT_VERIFIED_SIGNUP`,
  EMAIL_REQUIRED: `EMAIL_REQUIRED`,
  CONSUMER_NOT_FOUND_FOR_EMAIL: `CONSUMER_NOT_FOUND_FOR_EMAIL`,
  TOKEN_REQUIRED: `TOKEN_REQUIRED`,
  PASSWORD_REQUIRED: `PASSWORD_REQUIRED`,
  INVALID_CHANGE_PASSWORD_TOKEN: `INVALID_CHANGE_PASSWORD_TOKEN`,
  CONSUMER_NOT_FOUND_CHANGE_PASSWORD: `CONSUMER_NOT_FOUND_CHANGE_PASSWORD`,
  CHANGE_PASSWORD_FLOW_EXPIRED: `CHANGE_PASSWORD_FLOW_EXPIRED`,
  CONSUMER_NOT_FOUND_COMPLETE_PROFILE: `CONSUMER_NOT_FOUND_COMPLETE_PROFILE`,
  EMAIL_MISMATCH_GOOGLE: `EMAIL_MISMATCH_GOOGLE`,
  EMAIL_ALREADY_REGISTERED_SIGNUP: `EMAIL_ALREADY_REGISTERED_SIGNUP`,
  EMAIL_ALREADY_REGISTERED_PRISMA: `EMAIL_ALREADY_REGISTERED_PRISMA`,
  PASSWORD_REQUIREMENTS: `PASSWORD_REQUIREMENTS`,
  CONTRACTOR_KIND_REQUIRED: `CONTRACTOR_KIND_REQUIRED`,
  CONTRACTOR_KIND_NOT_FOR_BUSINESS: `CONTRACTOR_KIND_NOT_FOR_BUSINESS`,
  PERSONAL_DETAILS_REQUIRED: `PERSONAL_DETAILS_REQUIRED`,
  ORGANIZATION_DETAILS_REQUIRED: `ORGANIZATION_DETAILS_REQUIRED`,
  INVALID_DATE_OF_BIRTH: `INVALID_DATE_OF_BIRTH`,

  // Google OAuth – one code per throw (controller vs google-oauth.service)
  GOOGLE_ACCOUNT_NO_EMAIL_CALLBACK: `GOOGLE_ACCOUNT_NO_EMAIL_CALLBACK`,
  GOOGLE_ACCOUNT_NO_EMAIL_LOGIN: `GOOGLE_ACCOUNT_NO_EMAIL_LOGIN`,
  GOOGLE_EMAIL_NOT_VERIFIED_CALLBACK: `GOOGLE_EMAIL_NOT_VERIFIED_CALLBACK`,
  GOOGLE_EMAIL_NOT_VERIFIED_LOGIN: `GOOGLE_EMAIL_NOT_VERIFIED_LOGIN`,
  INVALID_GOOGLE_TOKEN_PAYLOAD: `INVALID_GOOGLE_TOKEN_PAYLOAD`,
  MISSING_GOOGLE_NONCE: `MISSING_GOOGLE_NONCE`,
  INVALID_GOOGLE_NONCE: `INVALID_GOOGLE_NONCE`,
  INVALID_GOOGLE_ID_TOKEN: `INVALID_GOOGLE_ID_TOKEN`,
  MISSING_GOOGLE_ID_TOKEN: `MISSING_GOOGLE_ID_TOKEN`,
  GOOGLE_ACCOUNT_MISMATCH: `GOOGLE_ACCOUNT_MISMATCH`,
  MISSING_SIGNUP_TOKEN: `MISSING_SIGNUP_TOKEN`,
  MISSING_EXCHANGE_TOKEN: `MISSING_EXCHANGE_TOKEN`,
  ORIGIN_REQUIRED: `ORIGIN_REQUIRED`,

  // Contacts
  CONTACT_NOT_FOUND: `CONTACT_NOT_FOUND`,
  CONTACT_EMAIL_ALREADY_EXISTS: `CONTACT_EMAIL_ALREADY_EXISTS`,

  // Exchange – one code per throw
  RATE_NOT_AVAILABLE: `RATE_NOT_AVAILABLE`,
  RATE_STALE: `RATE_STALE`,
  CURRENCIES_MUST_DIFFER_CREATE_RULE: `CURRENCIES_MUST_DIFFER_CREATE_RULE`,
  CURRENCIES_MUST_DIFFER_UPDATE_RULE: `CURRENCIES_MUST_DIFFER_UPDATE_RULE`,
  CURRENCIES_MUST_DIFFER_SCHEDULE: `CURRENCIES_MUST_DIFFER_SCHEDULE`,
  INVALID_TARGET_BALANCE_CREATE_RULE: `INVALID_TARGET_BALANCE_CREATE_RULE`,
  INVALID_TARGET_BALANCE_UPDATE_RULE: `INVALID_TARGET_BALANCE_UPDATE_RULE`,
  INVALID_MAX_CONVERT_AMOUNT_CREATE_RULE: `INVALID_MAX_CONVERT_AMOUNT_CREATE_RULE`,
  INVALID_MAX_CONVERT_AMOUNT_UPDATE_RULE: `INVALID_MAX_CONVERT_AMOUNT_UPDATE_RULE`,
  RULE_NOT_FOUND_UPDATE: `RULE_NOT_FOUND_UPDATE`,
  RULE_NOT_FOUND_DELETE: `RULE_NOT_FOUND_DELETE`,
  RULE_NOT_FOUND_CONVERT: `RULE_NOT_FOUND_CONVERT`,
  INVALID_EXECUTE_AT: `INVALID_EXECUTE_AT`,
  EXECUTE_AT_MUST_BE_FUTURE: `EXECUTE_AT_MUST_BE_FUTURE`,
  SCHEDULED_CONVERSION_NOT_FOUND_CANCEL: `SCHEDULED_CONVERSION_NOT_FOUND_CANCEL`,
  SCHEDULED_CONVERSION_NOT_FOUND_EXECUTE: `SCHEDULED_CONVERSION_NOT_FOUND_EXECUTE`,
  ONLY_PENDING_CONVERSIONS_CAN_CANCEL: `ONLY_PENDING_CONVERSIONS_CAN_CANCEL`,
  CONVERSION_ALREADY_EXECUTED: `CONVERSION_ALREADY_EXECUTED`,
  CONVERSION_CANCELLED: `CONVERSION_CANCELLED`,
  CONVERSION_ALREADY_PROCESSING: `CONVERSION_ALREADY_PROCESSING`,
  CANNOT_CONVERT_SAME_CURRENCY: `CANNOT_CONVERT_SAME_CURRENCY`,
  INVALID_AMOUNT_SCHEDULE: `INVALID_AMOUNT_SCHEDULE`,
  INVALID_AMOUNT_CONVERT: `INVALID_AMOUNT_CONVERT`,
  INSUFFICIENT_CURRENCY_BALANCE: `INSUFFICIENT_CURRENCY_BALANCE`,

  // Payment methods / Stripe – one code per throw
  PAYMENT_NOT_FOUND_STRIPE_CONSUMER: `PAYMENT_NOT_FOUND_STRIPE_CONSUMER`,
  PAYMENT_NOT_FOUND_STRIPE_REQUEST: `PAYMENT_NOT_FOUND_STRIPE_REQUEST`,
  PAYMENT_NOT_FOUND_STRIPE_ACCESS: `PAYMENT_NOT_FOUND_STRIPE_ACCESS`,
  PAYMENT_NOT_FOUND_STRIPE_CLAIM: `PAYMENT_NOT_FOUND_STRIPE_CLAIM`,
  PAYMENT_NOT_FOUND_STRIPE_CONFIRM: `PAYMENT_NOT_FOUND_STRIPE_CONFIRM`,
  PAYMENT_ALREADY_PROCESSED_CONFIRM: `PAYMENT_ALREADY_PROCESSED_CONFIRM`,
  PAYMENT_ALREADY_PROCESSED_PAY: `PAYMENT_ALREADY_PROCESSED_PAY`,
  INVALID_LEDGER_STATE_EMAIL_PAYMENT_STRIPE: `INVALID_LEDGER_STATE_EMAIL_PAYMENT_STRIPE`,
  CONSUMER_NOT_FOUND_STRIPE: `CONSUMER_NOT_FOUND_STRIPE`,
  CONSUMER_NOT_FOUND_WEBHOOK: `CONSUMER_NOT_FOUND_WEBHOOK`,
  STRIPE_NO_CLIENT_SECRET: `STRIPE_NO_CLIENT_SECRET`,
  STRIPE_SETUP_INTENT_NOT_SUCCEEDED: `STRIPE_SETUP_INTENT_NOT_SUCCEEDED`,
  STRIPE_NO_PAYMENT_METHOD: `STRIPE_NO_PAYMENT_METHOD`,
  ONLY_CARD_PAYMENT_METHODS: `ONLY_CARD_PAYMENT_METHODS`,
  PAYMENT_METHOD_NOT_FOUND: `PAYMENT_METHOD_NOT_FOUND`,
  PAYMENT_METHOD_CANNOT_REUSE_NO_ID: `PAYMENT_METHOD_CANNOT_REUSE_NO_ID`,
  PAYMENT_METHOD_CANNOT_REUSE_ATTACH: `PAYMENT_METHOD_CANNOT_REUSE_ATTACH`,
  PAYMENT_METHOD_CANNOT_REUSE_VERIFY: `PAYMENT_METHOD_CANNOT_REUSE_VERIFY`,

  // Invoice, Documents
  PAYMENT_REQUEST_NOT_FOUND_INVOICE: `PAYMENT_REQUEST_NOT_FOUND_INVOICE`,
  INVOICE_ACCESS_DENIED: `INVOICE_ACCESS_DENIED`,
  INVOICE_GENERATION_FAILED: `INVOICE_GENERATION_FAILED`,
  PAYMENT_NOT_OWNED: `PAYMENT_NOT_OWNED`,
  DOCUMENT_ACCESS_DENIED: `DOCUMENT_ACCESS_DENIED`,

  // Reversals – requester balance cannot go negative
  INSUFFICIENT_REQUESTER_BALANCE_REVERSAL_ADMIN: `INSUFFICIENT_REQUESTER_BALANCE_REVERSAL_ADMIN`,
  INSUFFICIENT_REQUESTER_BALANCE_REVERSAL_STRIPE: `INSUFFICIENT_REQUESTER_BALANCE_REVERSAL_STRIPE`,
} as const;

export function tryCodeOrNull(code: string): ErrorCode | null {
  return Object.values(errorCodes).includes(code as ErrorCode) ? (code as ErrorCode) : null;
}

export type ErrorCode = (typeof errorCodes)[keyof typeof errorCodes];
