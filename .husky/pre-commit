#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

yarn lint
# Build once to avoid repeated pretest noise in each app test run.
yarn --silent workspace @remoola/test-db run build >/dev/null 2>&1
(
  cd apps/consumer &&
    QUIET_MEMORY_GUARD=1 node ../../scripts/run-jest-with-memory-cap.js --passWithNoTests --verbose --coverage=false
)
(
  cd apps/api &&
    QUIET_MEMORY_GUARD=1 node ../../scripts/run-jest-with-memory-cap.js --passWithNoTests --verbose --coverage=false
)
